Приведен код для обработки данных. Результат приведен на картинке. Пометки и описание к скрипту написано в комментариях в коде. Обе задачи решены.
